<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Novella Maker Pro</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
</head>
<body>
    <div id="dynamic-bg" class="glass-bg"></div>
    <div class="app-container">
        <div class="top-nav">
            <div class="mode-selector">
                <button id="btn-author" class="active" onclick="switchRole('author')">–ê–≤—Ç–æ—Ä</button>
                <button id="btn-player" onclick="switchRole('player')">–ò–≥—Ä–æ–∫</button>
            </div>
            <div class="offline-switch">
                <span>–û—Ñ—Ñ–ª–∞–π–Ω</span>
                <label class="switch">
                    <input type="checkbox" id="offline-mode">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <main id="author-panel" class="main-card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h2 style="margin:0; font-size: 1.2rem;">–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ü–µ–Ω—ã</h2>
                <button id="idea-btn" style="background:none; border:none; font-size:1.5rem; cursor:pointer;">üí°</button>
            </div>
            
            <div class="settings-row" style="display: flex; gap: 10px;">
                <input type="text" id="location-input" placeholder="–õ–æ–∫–∞—Ü–∏—è...">
                <input type="color" id="bg-color" value="#6366f1" style="width: 60px; padding: 2px; height: 45px;">
            </div>

            <div class="img-upload-zone" style="margin-bottom: 10px;">
                <input type="file" id="image-input" accept="image/*" hidden>
                <button onclick="document.getElementById('image-input').click()" class="mode-btn" style="width:100%; margin-bottom: 5px;">üñºÔ∏è –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É</button>
                <div id="img-preview-container" style="display:none; position:relative;">
                    <img id="preview-src" src="" style="width:100%; border-radius:12px; margin-top:5px; border: 1px solid rgba(255,255,255,0.1);">
                    <button onclick="clearImage()" style="position:absolute; top:10px; right:10px; background:var(--accent); border:none; color:white; border-radius:50%; width:25px; height:25px; cursor:pointer;">√ó</button>
                </div>
            </div>

            <textarea id="quest-text" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏..."></textarea>

            <select id="action-type" onchange="updateActionUI()" style="margin-bottom: 15px;">
                <option value="choice">üîò –û–±—ã—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã</option>
                <option value="timed_choice">‚è≥ –í–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞ –≤—Ä–µ–º—è</option>
                <option value="clicker">‚ö° QTE –ö–ª–∏–∫–µ—Ä</option>
                <option value="text_input">‚úçÔ∏è –°–≤–æ–π –æ—Ç–≤–µ—Ç –∏–≥—Ä–æ–∫–∞</option>
            </select>

            <div id="ui-choice" class="interaction-setup">
                <div id="options-list">
                    <input type="text" class="opt-input" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –ê">
                    <input type="text" class="opt-input" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –ë">
                </div>
                <div class="opt-controls">
                    <button id="add-opt">+ –í–∞—Ä–∏–∞–Ω—Ç</button>
                    <button id="rem-opt">- –£–¥–∞–ª–∏—Ç—å</button>
                </div>
            </div>

            <div id="ui-timed" style="display:none;">
                <input type="number" id="time-limit" placeholder="–°–µ–∫—É–Ω–¥ –Ω–∞ –≤—ã–±–æ—Ä (–º–∞–∫—Å 60)">
            </div>

            <div id="ui-clicker" style="display:none;">
                <div style="display:flex; gap:10px;">
                    <input type="number" id="qte-target" placeholder="–ö–ª–∏–∫–æ–≤">
                    <input type="number" id="qte-time" placeholder="–°–µ–∫—É–Ω–¥">
                </div>
            </div>
            
            <button id="send-btn" class="primary-btn">–û–¢–ü–†–ê–í–ò–¢–¨ –°–¶–ï–ù–£</button>
            <div id="answers-history" style="margin-top: 20px;"></div>
        </main>

        <main id="player-panel" class="main-card" style="display:none;">
            <div id="player-loc" class="location-badge">–õ–æ–∫–∞—Ü–∏—è</div>
            <div id="player-img-box" style="display:none; margin-bottom:15px;">
                <img id="view-img" src="" style="width:100%; border-radius:15px;">
            </div>
            <div class="novella-view">
                <div id="player-story-text" class="story-text">–û–∂–∏–¥–∞–Ω–∏–µ —Ö–æ–¥–∞...</div>
                <div id="timer-bar" class="timer-bar" style="display:none;">
                    <div id="timer-fill" class="timer-fill"></div>
                </div>
                <div id="player-actions"></div>
            </div>
        </main>

        <div id="status-bar">–°–∏—Å—Ç–µ–º–∞: –ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>
    <script src="script.js"></script>
</body>
</html>
